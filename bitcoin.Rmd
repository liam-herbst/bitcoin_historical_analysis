---
title: "bitcoin"
output: html_document
---
### Import Libaries
```{r}
# All coin history data was sourced from [Crypto Download Data](https://www.cryptodatadownload.com/)
library(ggplot2)
library(dplyr)
library(devtools)
library(plotly)
library(quantmod)
library(xts)
```

# Clean & Read Bitcoin Historical Data
```{r}
# Read CSV data into R
btc_data <- read.csv("Coinbase_BTCUSD_d.csv", header = TRUE)
# Display the first 6 elements to ensure that the data is read
head(btc_data)
```
```{r}
# Order rows by date
btc = btc_data[order(btc_data$Date),]
head(btc)
```

```{r}
# Remove Timestamp & Symbol
btc = subset(btc, select = -c(Timestamp, Symbol))
# Check
head(btc)
```
```{r}
# Convert Date factor into date format
btc$Date <- as.Date(btc$Date, format = "%Y-%m-%d")
head(btc)
```
No irregularities to correct. The substantial variance between prices is due to Bitcoin's rapid ascent in price over the duration of the dataset. As shown in the next section.
## Historical Price Chart
```{r}
ds <- data.frame(Date = btc$Date, btc$Close, btc$Volume.USD)

ay <- list(
  tickfont = list(color = "Orange"),
  overlaying = "y",
  side = "right",
  title = "Trade Volume"
)
fig <- plot_ly(ds, x = ~Date)
fig <- fig %>% add_lines(y = ~btc$Close, name = "Price")
fig <- fig %>% add_lines(y = ~btc$Volume.USD, name = "Volume", yaxis = "y2")
fig <- fig %>% layout(
    title = "Bitcoin Price & Trade Volume",
    yaxis2 = ay,
    xaxis = list(
      rangeselector = list(
        buttons = list(
          list(
            count = 3,
            label = "3 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 6,
            label = "6 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 1,
            label = "1 yr",
            step = "year",
            stepmode = "backward"),
          list(
            count = 1,
            label = "YTD",
            step = "year",
            stepmode = "todate"),
          list(step = "all"))),
      rangeslider = list(type = "date")),
    yaxis = list(
      title = "Price (USD)",
      tickfont = list(color = "Blue"))
)
fig
```
## Display Summary Figures
```{r}
# 2014-2020 Summary
summary(btc)
#2 014
btc %>%
  filter(Date >= "2014-12-01") %>%
  filter(Date <= "2014-12-31") %>%
  summary(btc)
# 2015
btc %>%
  filter(Date >= "2015-01-01") %>%
  filter(Date <= "2015-12-31") %>%
  summary(btc)
# 2016
btc %>%
  filter(Date >= "2016-01-01") %>%
  filter(Date <= "2016-12-31") %>%
  summary(btc)
# 2017
btc %>%
  filter(Date >= "2017-01-01") %>%
  filter(Date <= "2017-12-31") %>%
  summary(btc)
# 2018
btc %>%
  filter(Date >= "2018-01-01") %>%
  filter(Date <= "2018-12-31") %>%
  summary(btc)
# 2019
btc %>%
  filter(Date >= "2019-01-01") %>%
  filter(Date <= "2019-12-31") %>%
  summary(btc)
# 2020
btc %>%
  filter(Date >= "2020-01-01") %>%
  filter(Date <= "2020-11-20") %>%
  summary(btc)
```
```{r}
# Map the correlation between Bitcoin's closing price and volume traded (in USD)
plot(btc$Close, btc$Volume.USD)
```
```{r}
# Map the correlation between Bitcoin's closing price and volume traded (in BTC)
plot(btc$Close, btc$Volume.BTC)
```
# Bitcoin to Google Search Interest
### Format BTC Database
*******************Add graph with two axisis plotly.com/r/multiple-axes
```{r}
# Create new database that filters for the first day of each month
# Create startpoints function
startpoints <- function (x, on = "months", k = 1) {
  head(endpoints(x, on, k) + 1, -1)
}
btc_m <- btc
btc_m <- btc_m[startpoints(btc_m$Date, on = "months"),]
head(btc_m)
```
### Add Google Search Data
```{r}
# Sourced from https://trends.google.com/trends/explore?date=2014-12-01%202020-11-20&geo=US&q=Bitcoin
# Read CSV data into R
search <- read.csv("btc_search_volume.csv", header = TRUE)
# Convert Date factor into date format
search$Date <- as.Date(search$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(search)
```
## Create Dual Y-Axis Comparable Graph
```{r}
ds <- data.frame(Date = btc_m$Date, btc_m$Close, search$Volume)

ay <- list(
  tickfont = list(color = "Orange"),
  overlaying = "y",
  side = "right",
  title = "Weighted Search Volume"
)
fig <- plot_ly(ds, x = ~Date)
fig <- fig %>% add_lines(x = ~Date, y = ~btc_m$Close, name = "Bitcoin")
fig <- fig %>% add_lines(y = ~search$Volume, name = "Google Search", yaxis = "y2")
fig <- fig %>% layout(
    title = "Bitcoin Price vs. Google Search Volume", 
    yaxis2 = ay,
    xaxis = list(
      rangeselector = list(
        buttons = list(
          list(
            count = 3,
            label = "3 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 6,
            label = "6 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 1,
            label = "1 yr",
            step = "year",
            stepmode = "backward"),
          list(
            count = 1,
            label = "YTD",
            step = "year",
            stepmode = "todate"),
          list(step = "all"))),
      rangeslider = list(type = "date")),
    yaxis = list(title = "Price (USD)")
  )

fig
```


# Compare Cryptocurrencies
### Ethereum Data
```{r}
# Read CSV data into R
eth_data <- read.csv("Coinbase_ETHUSD_d.csv", header = TRUE)
# Order rows by date
eth = eth_data[order(eth_data$Date),]
# Remove Timestamp & Symbol
eth = subset(eth, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor in date format
eth$Date <- as.Date(eth$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(eth)
```
### Litecoin Data
```{r}
# Read CSV data into R
ltc_data <- read.csv("Coinbase_LTCUSD_d.csv", header = TRUE)
# Order rows by date
ltc = ltc_data[order(ltc_data$Date),]
# Remove Timestamp & Symbol
ltc = subset(ltc, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
ltc$Date <- as.Date(ltc$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(ltc)
```
### Ripple Data
```{r}
# Read CSV data into R
xrp_data <- read.csv("Bitstamp_XRPUSD_d.csv", header = TRUE)
# Order rows by date
xrp = xrp_data[order(xrp_data$Date),]
# Remove Timestamp & Symbol
xrp = subset(xrp, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
xrp$Date <- as.Date(xrp$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(xrp)
```
### Monero Data
```{r}
# Read CSV data into R
xmr_data <- read.csv("Poloniex_XMRUSD_d.csv", header = TRUE)
# Order rows by date
xmr = xmr_data[order(xmr_data$Date),]
# Remove Timestamp & Symbol
xmr = subset(xmr, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
xmr$Date <- as.Date(xmr$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(xmr)
```
### Dash Data
```{r}
# Read CSV data into R
dash_data <- read.csv("Poloniex_DASHUSD_d.csv", header = TRUE)
# Order rows by date
dash = dash_data[order(dash_data$Date),]
# Remove Timestamp & Symbol
dash = subset(dash, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
dash$Date <- as.Date(dash$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(dash)
```
## Filter Rows for Consistency

# Compare With Traditional Investment Vehichles (Equities & bonds)
(representde by the Dow jones and US treasury bonds)

```{r}
ds <- data.frame(Date = btc$Date, btc$Close)

fig <- plot_ly(ds, x = ~Date)
fig <- fig %>% add_lines(y = ~btc$Close, name = "Bitcoin")
fig <- fig %>% layout(
    title = "Bitcoin Price",
    xaxis = list(
      rangeselector = list(
        buttons = list(
          list(
            count = 3,
            label = "3 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 6,
            label = "6 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 1,
            label = "1 yr",
            step = "year",
            stepmode = "backward"),
          list(
            count = 1,
            label = "YTD",
            step = "year",
            stepmode = "todate"),
          list(step = "all"))),

      rangeslider = list(type = "date")),

    yaxis = list(title = "Price (USD)"))

fig
```

*Evaluate Bitcoin Price Compared to the Top 5 Currencies*
```{r}
#plot_top_5_currencies()
```
