---
title: "bitcoin"
output: html_document
---
### Import Libaries
```{r}
# All coin history data was sourced from [Crypto Download Data](https://www.cryptodatadownload.com/)
library(ggplot2)
library(dplyr)
library(devtools)
library(plotly)
library(quantmod)
library(xts)
library(coinmarketcapr)
library(tidyverse)
library(PerformanceAnalytics)
```

# Evaluating Bitcoin
## Clean & Read Historical Data
```{r}
# Read CSV data into R
btc_data <- read.csv("Coinbase_BTCUSD_d.csv", header = TRUE)
# Display the first 6 elements to ensure that the data is read
head(btc_data)
```
```{r}
# Order rows by date
btc = btc_data[order(btc_data$Date),]
head(btc)
```

```{r}
# Remove Timestamp & Symbol
btc = subset(btc, select = -c(Timestamp, Symbol))
# Check
head(btc)
```
```{r}
# Convert Date factor into date format
btc$Date <- as.Date(btc$Date, format = "%Y-%m-%d")
head(btc)
```
No irregularities to correct. The substantial variance between prices is due to Bitcoin's rapid ascent in price over the duration of the dataset. As shown in the next section.
## Historical Price Chart
```{r}
ds <- data.frame(Date = btc$Date, btc$Close, btc$Volume.USD)

ay <- list(
  tickfont = list(color = "Orange"),
  overlaying = "y",
  side = "right",
  title = "Trade Volume"
)
fig <- plot_ly(ds, x = ~Date)
fig <- fig %>% add_lines(y = ~btc$Close, name = "Price")
fig <- fig %>% add_lines(y = ~btc$Volume.USD, name = "Volume", yaxis = "y2")
fig <- fig %>% layout(
    title = "Bitcoin Price & Trade Volume",
    yaxis2 = ay,
    xaxis = list(
      rangeselector = list(
        buttons = list(
          list(
            count = 3,
            label = "3 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 6,
            label = "6 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 1,
            label = "1 yr",
            step = "year",
            stepmode = "backward"),
          list(
            count = 1,
            label = "YTD",
            step = "year",
            stepmode = "todate"),
          list(step = "all"))),
      rangeslider = list(type = "date")),
    yaxis = list(
      title = "Price (USD)",
      tickfont = list(color = "Blue"))
)
fig
```
## Display Summary Figures
### 2014-2020 Summary
```{r}
summary(btc)
```
### 2014
```{r}
btc %>%
  filter(Date >= "2014-12-01") %>%
  filter(Date <= "2014-12-31") %>%
  summary(btc)
```
### 2015
```{r}
btc %>%
  filter(Date >= "2015-01-01") %>%
  filter(Date <= "2015-12-31") %>%
  summary(btc)
```
### 2016
```{r}
btc %>%
  filter(Date >= "2016-01-01") %>%
  filter(Date <= "2016-12-31") %>%
  summary(btc)
```
### 2017
```{r}
btc %>%
  filter(Date >= "2017-01-01") %>%
  filter(Date <= "2017-12-31") %>%
  summary(btc)
```
### 2018
```{r}
btc %>%
  filter(Date >= "2018-01-01") %>%
  filter(Date <= "2018-12-31") %>%
  summary(btc)
```
### 2019
```{r}
btc %>%
  filter(Date >= "2019-01-01") %>%
  filter(Date <= "2019-12-31") %>%
  summary(btc)
```
### 2020
```{r}
btc %>%
  filter(Date >= "2020-01-01") %>%
  filter(Date <= "2020-11-20") %>%
  summary(btc)
```
## Display Scatter Plots & Find Correlations
```{r}
btc_cor <- btc[, 2:7]
chart.Correlation(btc_cor)
```
In the above plot:

- The distribution of each variable is shown on the diagonal.
- On the bottom of the diagonal : the bivariate scatter plots with a fitted line are displayed
- On the top of the diagonal : the value of the correlation plus the significance level as stars
- Each significance level is associated to a symbol : p-values(0, 0.001, 0.01, 0.05, 0.1, 1) <=> symbols(“***”, “**”, “*”, “.”, " “)

These graphs show us that there is very little difference between the 'Open', 'High', 'Low', and 'Close' figures, so we are only going to remove all but the 'Close' variable and retest.
```{r}
# Remove the Open, High and Low variables
btc <- subset(btc, select = -c(Open, High, Low))
# Rename Close variable to Price
names(btc)[names(btc) == "Close"] <- "Price"
# Check 
head(btc)
```
```{r}
# Re-run correlation matrix &^ scatter plots
btc_cor <- btc[, 2:4]
chart.Correlation(btc_cor)
```
- The strongest linear relationship is between Volume.BTC and Volume.USD—as shown by the straight diagonal line and correlation of 0.77.
- The correlation between Price and Volume.USD is also high at 0.7 but the correlation betweeen Price and Volume.BTC is just inside the ideal threshold of < 0.4 or > -0.4 at 0.35. Since Volume.BTC it is the only x-variable that has a correlation inside the ideal threshold and it's with the y-variable we're trying to predict—Bitcoin-further evaluation will be needed with additional data sets to run a linear regression and more advanced data science methods for predicting the price of Bitcoin.
- All values have a p-value of ~0 (as represented by the ***) which means they are have a significant difference which isn't caused by chance

# Bitcoin to Google Search Interest
## Add Google Search Data
```{r}
# Sourced from https://trends.google.com/trends/explore?date=2014-12-01%202020-11-20&geo=US&q=Bitcoin
# Read CSV data into R
search <- read.csv("btc_search_volume.csv", header = TRUE)
# Convert Date factor into date format
search$Date <- as.Date(search$Date, format = "%Y-%m-%d")
# Display the first 6 elements to ensure that the data is read properly
head(search)
```
### Display Google Search Volume Summary
```{r}
summary(search)
```
## Format BTC Database
```{r}
# Create new database that filters for the first day of each month (since this is the only search volume data only available)
# Create startpoints function
startpoints <- function (x, on = "months", k = 1) {
  head(endpoints(x, on, k) + 1, -1)
}
btc_m <- btc
btc_m <- btc_m[startpoints(btc_m$Date, on = "months"),]
head(btc_m)
```
### Combine BTC Month and Google Search Data
```{r}
btc_search <- data.frame(btc_m, Volume.Search = search$Volume)
# Check
head(btc_search)
```
## Create Dual Y-Axis Comparable Graph
```{r}
ds <- data.frame(Date = btc_search$Date, btc_search$Price, btc_search$Volume.Search)

ay <- list(
  tickfont = list(color = "Orange"),
  overlaying = "y",
  side = "right",
  title = "Weighted Search Volume"
)
fig <- plot_ly(ds, x = ~Date)
fig <- fig %>% add_lines(x = ~Date, y = ~btc_search$Price, name = "Bitcoin")
fig <- fig %>% add_lines(y = ~btc_search$Volume.Search, name = "Google Search", yaxis = "y2")
fig <- fig %>% layout(
    title = "Bitcoin Price vs. Google Search Volume", 
    yaxis2 = ay,
    xaxis = list(
      rangeselector = list(
        buttons = list(
          list(
            count = 3,
            label = "3 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 6,
            label = "6 mo",
            step = "month",
            stepmode = "backward"),
          list(
            count = 1,
            label = "1 yr",
            step = "year",
            stepmode = "backward"),
          list(
            count = 1,
            label = "YTD",
            step = "year",
            stepmode = "todate"),
          list(step = "all"))),
      rangeslider = list(type = "date")),
    yaxis = list(title = "Price (USD)")
  )
fig
```
## Display Scatter Plots & Find Correlations
```{r}
btc_search_cor <- btc_search[, 2:5]
chart.Correlation(btc_search_cor)
```
All correaltions are above the 0.4 threshold so I am going to remove the highest (Volume.USD) and run again.
```{r}
btc_search_cor <- btc_search[, c(2,3,5)]
chart.Correlation(btc_search_cor)
```
The Volume.Search variable is still above the 0.4 threshold which'd bring us back to the original correlation matrix above (btc variables only). We can infer further evaluation is needed to predict the price of Bitcoin.
# Compare Cryptocurrencies
For simplicity, I am representing the price with the 'Close' variable and eliminating 'Open', 'High', and 'Low', for all cryptocurrencies and future finanical x.
### Format Bitcion Data
```{r}
# Rename Close variable to Price
names(btc)[names(btc) == "Close"] <- "BTC.Price"
# Rename Volume.USD to Currency
names(btc)[names(btc) == "Volume.USD"] <- "BTC.Volume.USD"
head(btc)
```
### Ethereum Data
```{r}
# Read CSV data into R
eth_data <- read.csv("Coinbase_ETHUSD_d.csv", header = TRUE)
# Order rows by date
eth = eth_data[order(eth_data$Date),]
# Remove Timestamp & Symbol
eth = subset(eth, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor in date format
eth$Date <- as.Date(eth$Date, format = "%Y-%m-%d")
# Remove the Open, High and Low variables
eth <- subset(eth, select = -c(Open, High, Low))
# Rename Close variable to Price
names(eth)[names(eth) == "Close"] <- "ETH.Price"
# Rename Volume.USD to Currency
names(eth)[names(eth) == "Volume.USD"] <- "ETH.Volume.USD"
# Display the first 6 elements to ensure that the data is read properly
head(eth)
```
### Litecoin Data
```{r}
# Read CSV data into R
ltc_data <- read.csv("Coinbase_LTCUSD_d.csv", header = TRUE)
# Order rows by date
ltc = ltc_data[order(ltc_data$Date),]
# Remove Timestamp & Symbol
ltc = subset(ltc, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
ltc$Date <- as.Date(ltc$Date, format = "%Y-%m-%d")
# Remove the Open, High and Low variables
ltc <- subset(ltc, select = -c(Open, High, Low))
# Rename Close variable to Price
names(ltc)[names(ltc) == "Close"] <- "LTC.Price"
# Rename Volume.USD to Currency
names(ltc)[names(ltc) == "Volume.USD"] <- "LTC.Volume.USD"
# Display the first 6 elements to ensure that the data is read properly
head(ltc)
```
### Ripple Data
```{r}
# Read CSV data into R
xrp_data <- read.csv("Bitstamp_XRPUSD_d.csv", header = TRUE)
# Order rows by date
xrp = xrp_data[order(xrp_data$Date),]
# Remove Timestamp & Symbol
xrp = subset(xrp, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
xrp$Date <- as.Date(xrp$Date, format = "%Y-%m-%d")
# Remove the Open, High and Low variables
xrp <- subset(xrp, select = -c(Open, High, Low))
# Rename Close variable to Price
names(xrp)[names(xrp) == "Close"] <- "XRP.Price"
# Rename Volume.USD to Currency
names(xrp)[names(xrp) == "Volume.USD"] <- "XRP.Volume.USD"
# Display the first 6 elements to ensure that the data is read properly
head(xrp)
```
### Monero Data
```{r}
# Read CSV data into R
xmr_data <- read.csv("Poloniex_XMRUSD_d.csv", header = TRUE)
# Order rows by date
xmr = xmr_data[order(xmr_data$Date),]
# Remove Timestamp & Symbol
xmr = subset(xmr, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
xmr$Date <- as.Date(xmr$Date, format = "%Y-%m-%d")
# Remove the Open, High and Low variables
xmr <- subset(xmr, select = -c(Open, High, Low))
# Rename Close variable to Price
names(xmr)[names(xmr) == "Close"] <- "XMR.Price"
# Rename Volume.USD to Currency
names(xmr)[names(xmr) == "Volume.USD"] <- "XMR.Volume.USD"
# Display the first 6 elements to ensure that the data is read properly
head(xmr)
```
### Dash Data
```{r}
# Read CSV data into R
dash_data <- read.csv("Poloniex_DASHUSD_d.csv", header = TRUE)
# Order rows by date
dash = dash_data[order(dash_data$Date),]
# Remove Timestamp & Symbol
dash = subset(dash, select = -c(Unix.Timestamp, Symbol))
# Convert Date factor into date format
dash$Date <- as.Date(dash$Date, format = "%Y-%m-%d")
# Remove the Open, High and Low variables
dash <- subset(dash, select = -c(Open, High, Low))
# Rename Close variable to Price
names(dash)[names(dash) == "Close"] <- "DASH.Price"
# Rename improperly formatted Volume.DAS & Volume.HUSD
names(dash)[names(dash) == "Volume.DAS"] <- "Volume.DASH"
names(dash)[names(dash) == "Volume.HUSD"] <- "DASH.Volume.USD"
# Display the first 6 elements to ensure that the data is read properly
head(dash)
```
## Filter Rows for Consistency
```{r}
# Total number of rows (from XRP database)
c_rows <- 1392
```

```{r}
# Format Bitcoin
btc_c <- tail(btc,n=c_rows)
(btc_c)
```
```{r}
# Check row count (find formula that'll return the number of rows for each)
```
## Normalize the Data

# Compare With Traditional Investment Vehichles (Equities & bonds)
(representde by the Dow jones and US treasury bonds)

*Evaluate Bitcoin Price Compared to the Top 5 Currencies*
```{r}
#plot_top_5_currencies()
```








### Display Large Scatter Plots
```{r}
# Map the correlation between Bitcoin's closing price and volume traded (in USD)
plot(btc$Price, btc$Volume.USD, main = 'Price to Volume (USD) Comparison', xlab = 'Closing Price', ylab = 'Volume (USD)')
```
```{r}
# Map the correlation between Bitcoin's closing price and volume traded (in BTC)
plot(btc$Price, btc$Volume.BTC, main = 'Price to Volume (BTC) Comparison', xlab = 'Closing Price', ylab = 'Volume (BTC)')
```
